--- linux-2.6.23-orig/arch/arm/mach-ixp4xx/nslu2-setup.c	2007-12-29 01:46:05.000000000 -0600
+++ linux-2.6.23/arch/arm/mach-ixp4xx/nslu2-setup.c	2007-12-29 02:12:04.000000000 -0600
@@ -25,6 +25,7 @@
 #include <asm/mach/arch.h>
 #include <asm/mach/flash.h>
 #include <asm/mach/time.h>
+#include <asm/io.h>
 
 static struct flash_platform_data nslu2_flash_data = {
 	.map_name		= "cfi_probe",
@@ -223,6 +224,9 @@
 
 static void __init nslu2_init(void)
 {
+	uint8_t __iomem *f;
+	int i;
+
 	ixp4xx_sys_init();
 
 	nslu2_flash_resource.start = IXP4XX_EXP_BUS_BASE(0);
@@ -239,6 +243,20 @@
 	(void)platform_device_register(&nslu2_uart);
 
 	platform_add_devices(nslu2_devices, ARRAY_SIZE(nslu2_devices));
+
+
+	/* Map in a portion of the flash and read the MAC address */
+	if ((f = ioremap(IXP4XX_EXP_BUS_BASE(0), 0x40000))) {
+		for (i = 0; i < 6; i++) {
+			nslu2_plat_eth[0].hwaddr[i] = readb(f + 0x3FFB0 + i);
+		}
+		iounmap(f);
+	}
+	printk(KERN_INFO "nslu2 mac: %.2x:%.2x:%.2x:%.2x:%.2x:%.2x\n",
+	       nslu2_plat_eth[0].hwaddr[0], nslu2_plat_eth[0].hwaddr[1],
+	       nslu2_plat_eth[0].hwaddr[2], nslu2_plat_eth[0].hwaddr[3],
+	       nslu2_plat_eth[0].hwaddr[4], nslu2_plat_eth[0].hwaddr[5]);
+
 }
 
 MACHINE_START(NSLU2, "Linksys NSLU2")
